Timings for one mutex, locking the entire array before accessing it at all (before any reads or writes). Modified to only touch the array once per mutex operation.
1000 threads. 100 array elements.


MATLAB Code to initialize array of timings:

timings = [3.018004 1.216295 1.020687 1.026790 1.022310 1.020316 1.027488 1.021466 1.022021 1.023987 1.021708 1.216156 3.024552 1.028453 1.017583 1.021047 1.022167 1.017423 1.021240 1.020105 1.018339 1.217401 1.030908 1.219773 1.022239 1.020535 1.212501 1.017272 3.236030 1.029591 1.019180 1.017970 1.021931 1.040378 1.022395 3.032107 1.021809 1.219379 1.027120 1.022838 1.018004 1.023882 1.018055 1.020904 1.020720 1.020127 1.023532 1.031340 1.022568 3.018212 1.018009 3.225937 1.029803 1.218983 1.024791 1.019026 3.426506 1.025940 1.218916 1.212906 1.021859 1.023141 1.023759 1.021452 1.224379 7.031136 1.017970 1.015101 1.031358 1.028025 1.018393 1.216699 1.026468 1.027513 3.221509 1.020776 1.021996 1.022138 1.032817 1.022901 1.022883 1.021205 1.019082 1.018108 1.217007 1.019895 1.025524 1.220939 1.027095 1.218669 1.026138 1.421551 1.021218 1.219841 1.027186 1.018587 1.020015 1.021044 1.220389 1.017929]





Code:


void *ServerEcho(void *args) {
    int clientFileDescriptor=(int)args;
    char str[STRMAX];

    read(clientFileDescriptor,str,STRMAX);

    char* pos = str;
    pos++;
    int index = atoi(pos);

    pthread_mutex_lock(&mutex);
    if (str[0] == 'w') {
        sprintf(str, "String %d has been modified by a write request", index);
        sprintf(theArray[index], "%s", str);
        write(clientFileDescriptor,str,STRMAX);
    } else {
        write(clientFileDescriptor,theArray[index],STRMAX);        
    }
    pthread_mutex_unlock(&mutex);
    
    read(clientFileDescriptor,str,STRMAX);

    close(clientFileDescriptor);
}







Data:


3.018004
1.216295
1.020687
1.026790
1.022310
1.020316
1.027488
1.021466
1.022021
1.023987
1.021708
1.216156
3.024552
1.028453
1.017583
1.021047
1.022167
1.017423
1.021240
1.020105
1.018339
1.217401
1.030908
1.219773
1.022239
1.020535
1.212501
1.017272
3.236030
1.029591
1.019180
1.017970
1.021931
1.040378
1.022395
3.032107
1.021809
1.219379
1.027120
1.022838
1.018004
1.023882
1.018055
1.020904
1.020720
1.020127
1.023532
1.031340
1.022568
3.018212
1.018009
3.225937
1.029803
1.218983
1.024791
1.019026
3.426506
1.025940
1.218916
1.212906
1.021859
1.023141
1.023759
1.021452
1.224379
7.031136
1.017970
1.015101
1.031358
1.028025
1.018393
1.216699
1.026468
1.027513
3.221509
1.020776
1.021996
1.022138
1.032817
1.022901
1.022883
1.021205
1.019082
1.018108
1.217007
1.019895
1.025524
1.220939
1.027095
1.218669
1.026138
1.421551
1.021218
1.219841
1.027186
1.018587
1.020015
1.021044
1.220389
1.017929

